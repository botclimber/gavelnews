pageBaseEndpoint = `${api}/news/current`

dateAsGlobal = getSubtractedDate(1);
readOnlyPage = false;

async function vote(voteValue, newId) {

  // Make the PATCH request
  fetch(`${api}/news/${newId}/${voteValue}`, {
    method: 'PATCH',
    headers: headerWithToken
  })
    .then(async response => {

      await hideButtons(newId)

      const data = await response.json()

      if (response.ok) {
        allData = data.allData.data.data // ? strange ...

        await setBarsContent(data.new_data)
      } else throw Error(data.msg)

    })
    .catch(error => {
      console.error('Error during PATCH request:', error);
      showErrorMessage(error)
    });
}

async function setContent(dataList, append = false) {
  // clear div content

  if (!append) news_div.innerHTML = "";

  dataList.forEach(r => {

    const newType = (r.new_type === undefined) ? "" : `<svg class="h-4 w-5" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 422.186 422.186" xml:space="preserve" fill="#000000" transform="matrix(-1, 0, 0, -1, 0, 0)rotate(-45)">
    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
    <g id="SVGRepo_iconCarrier"> 
    <g id="XMLID_14_">
    <path fill="#2c2c2c" d="M134.729,242.243c-1.47,0-2.85-0.58-3.89-1.62c-1.04-1.03-1.61-2.42-1.61-3.88 c0-1.47,0.57-2.86,1.61-3.89l142.05-142.06c9.82-9.81,23.05-15.42,36.38-15.42c0.14,0,0.29,0,0.44,0.01 c13.3,0.12,25.8,5.37,35.21,14.78s14.66,21.91,14.78,35.2c0.13,13.48-5.49,26.9-15.41,36.82l-218.71,218.71 c-12.88,12.87-30.02,19.97-48.29,19.97c-19.22,0-37.65-8.16-50.58-22.38c-10.67-11.74-16.94-26.93-17.63-42.76 c-0.86-19.44,6.22-37.69,19.93-51.4l237.89-237.9c16.19-16.19,37.72-25.1,60.61-25.1c22.9,0,44.42,8.91,60.61,25.1 c33.42,33.43,33.42,87.81,0,121.23l-161.24,161.24c-1.04,1.04-2.42,1.61-3.89,1.61s-2.85-0.57-3.89-1.61 c-1.04-1.04-1.61-2.42-1.61-3.89s0.57-2.85,1.61-3.89l161.24-161.24c14.12-14.11,21.89-32.88,21.89-52.83 c0-19.96-7.77-38.73-21.89-52.84c-14.11-14.11-32.87-21.88-52.83-21.88c-0.04,0-0.08,0-0.12,0 c-19.62,0.03-39.07,8.24-53.36,22.53l-237.24,237.24c-10.82,10.82-16.78,25.21-16.78,40.51s5.96,29.69,16.78,40.51 c11.16,11.17,25.83,16.75,40.5,16.75s29.35-5.58,40.51-16.75l219.34-219.34c8.65-8.65,12.76-20.64,11.26-32.89 c-0.85-7-3.6-13.64-7.95-19.2c-7.6-9.73-18.99-15.31-31.23-15.31c-10.54,0-20.46,4.11-27.92,11.57l-142.68,142.68 C137.579,241.663,136.199,242.243,134.729,242.243z"></path> 
    <path fill="#2c2c2c" d="M130.839,240.623c1.04,1.04,2.42,1.62,3.89,1.62s2.85-0.58,3.89-1.62l142.68-142.68c7.46-7.46,17.38-11.57,27.92-11.57 c12.24,0,23.63,5.58,31.23,15.31c4.35,5.56,7.1,12.2,7.95,19.2c1.5,12.25-2.61,24.24-11.26,32.89l-219.34,219.34 c-11.16,11.17-25.84,16.75-40.51,16.75s-29.34-5.58-40.5-16.75c-10.82-10.82-16.78-25.21-16.78-40.51s5.96-29.69,16.78-40.51 l237.24-237.24c14.29-14.29,33.74-22.5,53.36-22.53c0.04,0,0.08,0,0.12,0c19.96,0,38.72,7.77,52.83,21.88 c14.12,14.11,21.89,32.88,21.89,52.84c0,19.95-7.77,38.72-21.89,52.83l-161.24,161.24c-1.04,1.04-1.61,2.42-1.61,3.89 s0.57,2.85,1.61,3.89c1.04,1.04,2.42,1.61,3.89,1.61s2.85-0.57,3.89-1.61l161.24-161.24c33.42-33.42,33.42-87.8,0-121.23 c-16.19-16.19-37.71-25.1-60.61-25.1c-22.89,0-44.42,8.91-60.61,25.1l-237.89,237.9c-13.71,13.71-20.79,31.96-19.93,51.4 c0.69,15.83,6.96,31.02,17.63,42.76c12.93,14.22,31.36,22.38,50.58,22.38c18.27,0,35.41-7.1,48.29-19.97l218.71-218.71 c9.92-9.92,15.54-23.34,15.41-36.82c-0.12-13.29-5.37-25.79-14.78-35.2s-21.91-14.66-35.21-14.78c-0.15-0.01-0.3-0.01-0.44-0.01 c-13.33,0-26.56,5.61-36.38,15.42l-142.05,142.06c-1.04,1.03-1.61,2.42-1.61,3.89 C129.229,238.203,129.799,239.593,130.839,240.623z M394.489,40.063c36.93,36.93,36.93,97.02,0,133.95l-161.25,161.24 c-2.73,2.74-6.38,4.25-10.25,4.25c-3.87,0-7.51-1.51-10.25-4.25c-2.74-2.73-4.25-6.38-4.25-10.25s1.51-7.51,4.25-10.25 l161.24-161.24c12.41-12.42,19.25-28.92,19.25-46.47c0-17.56-6.84-34.06-19.25-46.47c-12.41-12.42-28.91-19.25-46.47-19.25 c-0.03,0-0.07,0-0.11,0c-17.25,0.02-34.39,7.28-47.01,19.9l-237.24,237.24c-9.12,9.12-14.14,21.24-14.14,34.14 s5.02,25.03,14.14,34.15c18.83,18.82,49.46,18.82,68.29,0l219.34-219.34c6.68-6.68,9.84-15.95,8.69-25.44 c-0.66-5.38-2.77-10.47-6.11-14.74c-5.89-7.54-14.69-11.86-24.14-11.86c-8.14,0-15.79,3.17-21.55,8.93l-142.69,142.69 c-5.65,5.65-14.85,5.65-20.51,0c-5.65-5.66-5.65-14.85,0-20.51l142.06-142.05c11.62-11.62,27.44-18.19,43.26-18.05 c15.67,0.14,30.41,6.33,41.49,17.42c11.09,11.08,17.27,25.81,17.42,41.48c0.15,15.87-6.43,31.64-18.05,43.27l-218.71,218.7 c-14.57,14.58-33.98,22.61-54.65,22.61c-21.75,0-42.61-9.23-57.24-25.33c-12.08-13.29-19.17-30.49-19.97-48.41 c-0.97-21.99,7.05-42.65,22.56-58.17l237.9-237.89c17.89-17.89,41.67-27.74,66.97-27.74 C352.809,12.323,376.599,22.173,394.489,40.063z"></path> </g> </g> </g> </g></svg>${r.new_type}`

    const percentages = transformToPercentages(r.new_isTrue, r.new_isFalse, r.new_noOpinion, r.new_isUnclear)

    const isTruePerc = percentages.isTruePerc
    const isFalsePerc = percentages.isFalsePerc
    const noOpinionPerc = percentages.noOpinionPerc
    const isUnclearPerc = percentages.isUnclearPerc

    const isVoted = (r.isVoted === undefined || r.isVoted) ? "hidden" : ""

    const img = (r.new_img)? `<img src="${r.new_img}" class="w-full h-full object-cover" alt="" />` : `<img src="https://t4.ftcdn.net/jpg/04/99/93/31/360_F_499933117_ZAUBfv3P1HEOsZDrnkbNCt4jc3AodArl.jpg" class="w-full h-full object-cover" alt="" />`
    const desc = r.new_desc ?? ""

    news_div.innerHTML += /* html */
      `<div id="${r.new_id}" class="mb-6 lg:mb-0">
                <div >
                <a href="${r.new_link}" onmouseover="setNewForChat('${r.new_id}')" onmouseout="setNewForChat(null)" target="_blank">  
                <div class="relative h-[220px] mb-6 overflow-hidden rounded-lg bg-cover bg-no-repeat shadow-lg dark:shadow-black/20" data-te-ripple-init data-te-ripple-color="light">
                  ${img}
                </div>
                </a>
        
                  <!-- Colored bar based on user votes -->
                  <div class="flex justify-center mb-2" id="bar-${r.new_id}">
                    <div class="w-full h-3 bg-[#8CB369] rounded-l-full relative" style="width: ${isTruePerc}%;">
                      <span class="tooltip-text">${isTruePerc}% (${r.new_isTrue})</span>
                    </div>
                    <div class="w-full h-3 bg-[#717171] relative" style="width: ${noOpinionPerc}%;">
                      <span class="tooltip-text">${noOpinionPerc}% (${r.new_noOpinion})</span>
                    </div>
                    <div class="w-full h-3 bg-[#F4A259] relative" style="width: ${isUnclearPerc}%;">
                      <span class="tooltip-text">${isUnclearPerc}% (${r.new_isUnclear})</span>
                    </div>
                    <div class="w-full h-3 bg-[#BC4B51] rounded-r-full relative" style="width: ${isFalsePerc}%;">
                      <span class="tooltip-text">${isFalsePerc}% (${r.new_isFalse})</span>
                    </div>
                </div>
        
                <!-- Buttons for user feedback -->
                <div class=" ${isVoted} flex justify-center items-center mb-5" id = "toVoteButtons-${r.new_id}">
                    <button onclick="vote('new_isTrue','${r.new_id}')" style="border:1px solid #d0d0d0" class="text-sm px-[8px] py-[2px] rounded-[5px] bg-[#8CB369] text-white font-bold mr-1">
                    <svg class="w-5 h-5" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512.001 512.001" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <circle style="fill:#F7B239;" cx="256.004" cy="256.005" r="246.855"></circle> <path style="fill:#E09B2D;" d="M126.306,385.694c-88.801-88.802-95.798-228.426-20.998-325.242 c-8.286,6.401-16.258,13.399-23.858,20.999c-96.401,96.401-96.401,252.698,0,349.099s252.698,96.401,349.099,0 c7.599-7.599,14.597-15.573,20.999-23.858C354.733,481.492,215.108,474.495,126.306,385.694z"></path> <path d="M256.001,512.001C114.841,512.001,0,397.16,0,256.001S114.841,0.001,256.001,0.001S512.001,114.842,512.001,256 C512,397.16,397.16,512.001,256.001,512.001z M256.001,18.3c-131.069,0-237.702,106.632-237.702,237.702 s106.632,237.702,237.702,237.702S493.702,387.07,493.702,256.001C493.701,124.932,387.068,18.3,256.001,18.3z"></path> <path d="M198.659,239.675c-3.115,0-6.15-1.591-7.863-4.459c-8.265-13.834-22.821-22.094-38.937-22.094s-30.672,8.259-38.937,22.094 c-2.59,4.338-8.208,5.753-12.547,3.162c-4.338-2.592-5.753-8.209-3.162-12.547c11.6-19.417,32.028-31.007,54.646-31.007 s43.046,11.592,54.646,31.007c2.591,4.338,1.176,9.956-3.162,12.547C201.873,239.258,200.254,239.675,198.659,239.675z"></path> <path d="M406.941,239.675c-3.115,0-6.15-1.591-7.863-4.459c-8.265-13.834-22.821-22.094-38.938-22.094 c-16.115,0-30.671,8.26-38.936,22.094c-2.591,4.338-8.209,5.753-12.547,3.162c-4.338-2.591-5.753-8.209-3.162-12.547 c11.6-19.415,32.028-31.007,54.645-31.007c22.618,0,43.046,11.591,54.647,31.007c2.591,4.338,1.176,9.955-3.162,12.547 C410.156,239.258,408.538,239.675,406.941,239.675z"></path> <path d="M256.001,374.196c-49.637,0-99.254-18.887-137.042-56.673c-3.573-3.573-3.573-9.365,0-12.939 c3.574-3.573,9.367-3.573,12.94,0c68.425,68.429,179.77,68.43,248.203,0c3.576-3.573,9.368-3.572,12.94,0 c3.573,3.573,3.573,9.367,0,12.94C355.263,355.301,305.623,374.196,256.001,374.196z"></path> <path style="fill:#E09B2D;" d="M256.001,409.692c-14.756,0-29.505-2.01-43.85-6.033c-4.865-1.364-7.704-6.414-6.34-11.28 c1.364-4.865,6.411-7.705,11.28-6.34c25.454,7.137,52.365,7.138,77.821,0c4.869-1.364,9.916,1.475,11.28,6.34 c1.364,4.866-1.475,9.916-6.34,11.28C285.509,407.68,270.751,409.692,256.001,409.692z"></path> </g></svg>
                    </button>
                    <button onclick="vote('new_noOpinion','${r.new_id}')" style="border:1px solid #d0d0d0" class="text-sm px-[8px] py-[2px] border-1 border-[white] rounded-[5px] bg-[#717171] text-white font-bold mr-1">
                    <svg class="w-5 h-5" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512.001 512.001" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <circle style="fill:#F7B239;" cx="256.005" cy="256.004" r="246.855"></circle> <path style="fill:#E09B2D;" d="M126.308,385.694c-88.802-88.802-95.799-228.426-20.999-325.241 c-8.286,6.401-16.258,13.399-23.858,20.999c-96.401,96.401-96.401,252.698,0,349.099s252.698,96.401,349.099,0 c7.599-7.599,14.597-15.573,20.999-23.858C354.735,481.492,215.109,474.495,126.308,385.694z"></path> <path d="M256.001,0C114.842,0,0.001,114.841,0.001,256.001s114.841,256.001,256.001,256.001 c141.158,0,255.999-114.841,255.999-256.001S397.159,0,256.001,0z M256.001,493.701c-131.069,0-237.702-106.631-237.702-237.7 S124.932,18.299,256.001,18.299c131.068,0,237.7,106.632,237.7,237.702S387.069,493.701,256.001,493.701z"></path> <path d="M146.725,209.658c-18.666,0-33.852,15.186-33.852,33.852s15.186,33.852,33.852,33.852s33.852-15.186,33.852-33.852 S165.391,209.658,146.725,209.658z"></path> <path d="M365.277,209.658c-18.666,0-33.852,15.186-33.852,33.852s15.186,33.852,33.852,33.852s33.852-15.186,33.852-33.852 S383.942,209.658,365.277,209.658z"></path> <path d="M319.765,308.112c-2.623-4.317-8.25-5.693-12.57-3.069L256,336.143l-51.195-31.101c-4.319-2.623-9.946-1.249-12.57,3.069 c-2.624,4.319-1.249,9.946,3.069,12.57l43.074,26.168l-43.074,26.168c-4.319,2.623-5.693,8.252-3.069,12.57 c1.721,2.834,4.737,4.4,7.828,4.4c1.619,0,3.257-0.429,4.742-1.331L256,357.556l51.195,31.101c1.485,0.902,3.123,1.331,4.742,1.331 c3.09,0,6.107-1.566,7.828-4.4c2.624-4.319,1.249-9.946-3.069-12.57l-43.074-26.168l43.074-26.168 C321.014,318.058,322.389,312.43,319.765,308.112z"></path> <g> <circle style="fill:#FFFFFF;" cx="155.25" cy="235.997" r="9.15"></circle> <circle style="fill:#FFFFFF;" cx="373.619" cy="235.997" r="9.15"></circle> </g> </g></svg>
                    </button>
                    <button onclick="vote('new_isUnclear','${r.new_id}')" style="border:1px solid #d0d0d0" class="text-sm px-[8px] py-[2px] border-1 border-[white] rounded-[5px] bg-[#F4A259] text-white font-bold mr-1">
                    <svg class="w-5 h-5" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512.001 512.001" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <circle style="fill:#F7B239;" cx="263.97" cy="252.612" r="239.161"></circle> <path style="fill:#E09B2D;" d="M138.322,378.259C52.289,292.225,45.51,156.952,117.979,63.154 c-8.028,6.202-15.751,12.981-23.115,20.344c-93.396,93.396-93.396,244.823,0,338.219s244.823,93.396,338.219,0 c7.362-7.362,14.142-15.087,20.344-23.115C359.629,471.072,224.356,464.294,138.322,378.259z"></path> <circle style="fill:#A6DAF7;" cx="158.105" cy="235.19" r="91.433"></circle> <path style="fill:#B27214;" d="M210.508,135.408c55.018,28.886,76.281,97.166,47.383,152.184 c-19.537,37.207-57.808,60.325-99.86,60.325c-18.119,0-36.214-4.479-52.335-12.942c-26.652-13.994-46.26-37.538-55.207-66.282 s-6.17-59.261,7.836-85.914c19.537-37.207,57.796-60.313,99.86-60.313C176.291,122.466,194.386,126.934,210.508,135.408z M229.04,272.463c20.577-39.204,5.496-87.663-33.696-108.24c-39.204-20.589-87.663-5.508-108.24,33.696 c-20.589,39.192-5.508,87.651,33.697,108.24C159.993,326.737,208.451,311.656,229.04,272.463z"></path> <path style="fill:#F95428;" d="M83.835,376.608L83.835,376.608c-11.268-5.918-25.201-1.58-31.119,9.688l-41.213,78.476 c-5.918,11.268-1.58,25.201,9.688,31.119l0,0c11.268,5.918,25.201,1.58,31.119-9.688l41.213-78.476 C99.441,396.459,95.103,382.526,83.835,376.608z"></path> <path style="fill:#E09B2D;" d="M297.768,413.309H230.18c-4.896,0-8.864-3.969-8.864-8.864s3.969-8.864,8.864-8.864h67.588 c4.897,0,8.864,3.969,8.864,8.864S302.664,413.309,297.768,413.309z"></path> <path d="M263.974,4.588c-136.762,0-248.026,111.263-248.026,248.026c0,43.554,11.381,86.123,32.966,123.599 c-1.549,1.81-2.912,3.801-4.047,5.962L3.654,460.65c-8.18,15.578-2.163,34.908,13.416,43.089c4.643,2.438,9.699,3.675,14.799,3.675 c3.188,0,6.393-0.483,9.524-1.458c8.139-2.534,14.802-8.086,18.765-15.631l31.27-59.542c21.039,20.409,45.239,36.749,72.091,48.657 c31.704,14.059,65.502,21.187,100.456,21.187c136.762,0,248.026-111.259,248.026-248.014C512,115.851,400.736,4.588,263.974,4.588z M44.461,482.081c-1.761,3.353-4.723,5.821-8.34,6.946c-3.617,1.126-7.457,0.777-10.81-0.985 c-6.922-3.636-9.598-12.227-5.962-19.149l41.213-78.476c1.761-3.353,4.723-5.821,8.34-6.946c1.391-0.433,2.815-0.648,4.232-0.648 c2.266,0,4.513,0.55,6.576,1.633l0,0c3.353,1.761,5.821,4.723,6.946,8.34c1.125,3.617,0.777,7.456-0.985,10.81L44.461,482.081z M263.974,482.898c-32.463,0-63.842-6.616-93.27-19.666c-26.526-11.764-50.266-28.191-70.655-48.87l1.32-2.514 c3.963-7.547,4.75-16.184,2.216-24.323c-1.629-5.234-4.511-9.851-8.364-13.539l14.358-27.343 c15.277,6.644,31.855,10.137,48.45,10.137c45.362,0,86.635-24.933,107.708-65.067c15.078-28.705,18.057-61.609,8.394-92.649 c-9.666-31.04-30.797-56.434-59.499-71.504c-17.374-9.133-36.894-13.961-56.448-13.961c-45.366,0-86.637,24.928-107.707,65.055 c-15.105,28.744-18.107,61.656-8.453,92.672c8.769,28.171,27.026,51.703,51.85,67.093l-14.347,27.324 c-5.176-1.068-10.562-0.832-15.75,0.759c-19.714-34.576-30.099-73.781-30.099-113.889c0-126.987,103.31-230.297,230.297-230.297 c126.985,0,230.297,103.31,230.297,230.297C494.271,379.593,390.961,482.898,263.974,482.898z M109.815,327.127 c-24.556-12.894-42.62-34.581-50.864-61.069c-8.246-26.494-5.683-54.605,7.22-79.158c17.999-34.277,53.256-55.57,92.012-55.57 c16.692,0,33.358,4.124,48.203,11.927c24.513,12.87,42.56,34.562,50.817,61.079c8.257,26.519,5.715,54.622-7.161,79.135 c-18.002,34.284-53.26,55.581-92.012,55.581C141.35,339.053,124.678,334.929,109.815,327.127z"></path> <path d="M236.887,276.586l0.001-0.001c22.817-43.47,6.028-97.395-37.423-120.209c-21.058-11.058-45.158-13.256-67.862-6.19 c-22.705,7.068-41.296,22.557-52.348,43.612c-11.059,21.052-13.258,45.149-6.191,67.853c7.067,22.705,22.556,41.299,43.614,52.358 c13.172,6.915,27.3,10.192,41.237,10.192C189.963,324.2,220.98,306.867,236.887,276.586z M124.922,298.312 c-16.865-8.856-29.269-23.748-34.928-41.931c-5.66-18.181-3.899-37.48,4.959-54.342c8.851-16.864,23.739-29.267,41.921-34.927 c6.993-2.177,14.15-3.255,21.272-3.255c11.395,0,22.699,2.763,33.077,8.214c34.797,18.27,48.241,61.457,29.969,96.27 C202.912,303.139,159.724,316.584,124.922,298.312z"></path> <path style="fill:#666666;" d="M158.104,202.391c-18.085,0-32.797,14.713-32.797,32.797s14.713,32.797,32.797,32.797 s32.797-14.713,32.797-32.797S176.188,202.391,158.104,202.391z"></path> <path d="M416.445,198.802h-93.203c-4.897,0-8.864,3.969-8.864,8.864c0,4.895,3.968,8.864,8.864,8.864h19.651 c-3.681,5.301-5.846,11.729-5.846,18.658c0,5.431,1.334,10.553,3.682,15.068h-2.09c-4.897,0-8.864,3.969-8.864,8.864 s3.968,8.864,8.864,8.864h62.41c4.897,0,8.864-3.969,8.864-8.864s-3.968-8.864-8.864-8.864h-2.088 c2.346-4.515,3.682-9.637,3.682-15.068c0-6.928-2.165-13.357-5.846-18.658h19.651c4.897,0,8.864-3.969,8.864-8.864 C425.312,202.77,421.342,198.802,416.445,198.802z"></path> <path d="M333.113,367.215H194.834c-4.896,0-8.864,3.969-8.864,8.864s3.969,8.864,8.864,8.864h138.277 c4.897,0,8.864-3.969,8.864-8.864S338.008,367.215,333.113,367.215z"></path> <g> <circle style="fill:#FFFFFF;" cx="170.988" cy="231.881" r="8.864"></circle> <circle style="fill:#FFFFFF;" cx="382.551" cy="231.881" r="8.864"></circle> </g> </g></svg>
                    </button>
                    <button onclick="vote('new_isFalse','${r.new_id}')" style="border:1px solid #d0d0d0" class="text-sm px-[8px] py-[2px] border-1 border-[white] rounded-[5px] bg-[#BC4B51] text-white font-bold">
                    <svg class="w-5 h-5" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512.001 512.001" xml:space="preserve" fill="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <circle style="fill:#F7B239;" cx="256.005" cy="256.004" r="246.855"></circle> <g> <path style="fill:#E09B2D;" d="M126.308,385.694c-88.802-88.802-95.799-228.426-20.999-325.241 c-8.286,6.401-16.258,13.399-23.858,20.999c-96.401,96.401-96.401,252.698,0,349.099s252.698,96.401,349.099,0 c7.599-7.599,14.597-15.573,20.999-23.858C354.735,481.492,215.109,474.495,126.308,385.694z"></path> <path style="fill:#E09B2D;" d="M277.825,369.891c-2.06,0-4.132-0.692-5.841-2.111c-10.904-9.054-21.06-9.056-31.966,0 c-3.888,3.227-9.656,2.694-12.885-1.194c-3.228-3.888-2.694-9.656,1.194-12.885c17.588-14.605,37.761-14.604,55.347,0 c3.888,3.228,4.422,8.997,1.194,12.885C283.059,368.766,280.451,369.891,277.825,369.891z"></path> </g> <path d="M256,0C114.842,0,0.001,114.841,0.001,256.001S114.842,512.001,256,512.001c141.159,0,256.001-114.841,256.001-256.001 S397.159,0,256,0z M256,493.701c-131.068,0-237.7-106.631-237.7-237.7S124.932,18.299,256,18.299 c131.069,0,237.702,106.632,237.702,237.702S387.069,493.701,256,493.701z"></path> <path d="M112.923,204.662c8.265-13.834,22.821-22.094,38.937-22.094s30.672,8.26,38.937,22.094c1.713,2.868,4.749,4.458,7.864,4.458 c1.597,0,3.213-0.418,4.683-1.297c4.338-2.592,5.753-8.209,3.162-12.547c-11.6-19.417-32.028-31.007-54.646-31.007 s-43.046,11.592-54.646,31.007c-2.592,4.338-1.176,9.956,3.162,12.547C104.717,210.416,110.332,209,112.923,204.662z"></path> <path d="M360.143,164.268c-22.618,0-43.046,11.592-54.646,31.007c-2.592,4.338-1.176,9.956,3.162,12.547 c4.341,2.592,9.957,1.176,12.547-3.162c8.265-13.834,22.821-22.094,38.937-22.094s30.672,8.26,38.937,22.094 c1.713,2.868,4.749,4.458,7.864,4.458c1.597,0,3.213-0.418,4.683-1.297c4.338-2.592,5.753-8.209,3.162-12.547 C403.188,175.86,382.759,164.268,360.143,164.268z"></path> <path d="M190.337,263.692c0-18.666-15.186-33.852-33.852-33.852h-43.396c-5.053,0-9.15,4.097-9.15,9.15 c0,5.053,4.097,9.15,9.15,9.15h13.342c-2.422,4.661-3.8,9.947-3.8,15.553c0,18.666,15.186,33.852,33.852,33.852 S190.337,282.359,190.337,263.692z"></path> <path d="M375.036,229.84h-43.394c-5.053,0-9.15,4.097-9.15,9.15c0,5.053,4.097,9.15,9.15,9.15h13.342 c-2.422,4.661-3.8,9.947-3.8,15.553c0,18.666,15.186,33.852,33.852,33.852s33.852-15.186,33.852-33.852 C408.888,245.026,393.702,229.84,375.036,229.84z"></path> <path d="M256.001,305.642c-31.507,0-59.964,16.147-76.123,43.194c-2.592,4.338-1.176,9.956,3.162,12.547 c4.339,2.591,9.956,1.176,12.547-3.162c12.825-21.466,35.409-34.282,60.414-34.282s47.589,12.815,60.414,34.282 c1.714,2.868,4.749,4.459,7.864,4.458c1.596,0,3.213-0.418,4.683-1.297c4.338-2.592,5.753-8.209,3.162-12.547 C315.965,321.789,287.507,305.642,256.001,305.642z"></path> <g> <circle style="fill:#FFFFFF;" cx="163.692" cy="257.139" r="9.15"></circle> <circle style="fill:#FFFFFF;" cx="382.061" cy="257.139" r="9.15"></circle> </g> </g></svg>
                    </button>
                </div>
        
                  <h5 class="mb-3 text-md font-bold"><a href="${r.new_link}" target="_blank">${r.new_title}</a></h5>
                  <div class="mb-3 flex items-center justify-center text-sm font-medium text-yellow-600">
                    ${newType}
                  </div>
                  <p class=" mb-4 text-sm text-neutral-500 dark:text-neutral-700">
                    ${desc}
                  </p>
                  <button title="Copy link to current chat" onclick="insertNewInInput('${r.new_id}')" class="bg-[#2c2c2c] hover:bg-[#7b7575] text-[8pt] text-white font-bold py-1 px-2 rounded inline-flex items-center">
                  <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#000000"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M10.0464 14C8.54044 12.4882 8.67609 9.90087 10.3494 8.22108L15.197 3.35462C16.8703 1.67483 19.4476 1.53865 20.9536 3.05046C22.4596 4.56228 22.3239 7.14956 20.6506 8.82935L18.2268 11.2626" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> <path opacity="0.5" d="M13.9536 10C15.4596 11.5118 15.3239 14.0991 13.6506 15.7789L11.2268 18.2121L8.80299 20.6454C7.12969 22.3252 4.55237 22.4613 3.0464 20.9495C1.54043 19.4377 1.67609 16.8504 3.34939 15.1706L5.77323 12.7373" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> </g></svg>
                  </button>
                  <button title="Copy chat link to current chat" onclick="insertRoomInInput('${r.new_id}')" class="bg-[#2c2c2c] hover:bg-[#7b7575] text-[8pt] text-white font-bold py-1 px-2 rounded inline-flex items-center">
                  <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier" > <path  fill="#fff" d="M13.0867 21.3877L13.7321 21.7697L13.0867 21.3877ZM13.6288 20.4718L12.9833 20.0898L13.6288 20.4718ZM10.3712 20.4718L9.72579 20.8539H9.72579L10.3712 20.4718ZM10.9133 21.3877L11.5587 21.0057L10.9133 21.3877ZM1.25 10.5C1.25 10.9142 1.58579 11.25 2 11.25C2.41421 11.25 2.75 10.9142 2.75 10.5H1.25ZM3.07351 15.6264C2.915 15.2437 2.47627 15.062 2.09359 15.2205C1.71091 15.379 1.52918 15.8177 1.68769 16.2004L3.07351 15.6264ZM7.78958 18.9915L7.77666 19.7413L7.78958 18.9915ZM5.08658 18.6194L4.79957 19.3123H4.79957L5.08658 18.6194ZM21.6194 15.9134L22.3123 16.2004V16.2004L21.6194 15.9134ZM16.2104 18.9915L16.1975 18.2416L16.2104 18.9915ZM18.9134 18.6194L19.2004 19.3123H19.2004L18.9134 18.6194ZM19.6125 2.7368L19.2206 3.37628L19.6125 2.7368ZM21.2632 4.38751L21.9027 3.99563V3.99563L21.2632 4.38751ZM4.38751 2.7368L3.99563 2.09732V2.09732L4.38751 2.7368ZM2.7368 4.38751L2.09732 3.99563H2.09732L2.7368 4.38751ZM9.40279 19.2098L9.77986 18.5615L9.77986 18.5615L9.40279 19.2098ZM13.7321 21.7697L14.2742 20.8539L12.9833 20.0898L12.4412 21.0057L13.7321 21.7697ZM9.72579 20.8539L10.2679 21.7697L11.5587 21.0057L11.0166 20.0898L9.72579 20.8539ZM12.4412 21.0057C12.2485 21.3313 11.7515 21.3313 11.5587 21.0057L10.2679 21.7697C11.0415 23.0767 12.9585 23.0767 13.7321 21.7697L12.4412 21.0057ZM10.5 2.75H13.5V1.25H10.5V2.75ZM21.25 10.5V11.5H22.75V10.5H21.25ZM7.8025 18.2416C6.54706 18.2199 5.88923 18.1401 5.37359 17.9265L4.79957 19.3123C5.60454 19.6457 6.52138 19.7197 7.77666 19.7413L7.8025 18.2416ZM1.68769 16.2004C2.27128 17.6093 3.39066 18.7287 4.79957 19.3123L5.3736 17.9265C4.33223 17.4951 3.50486 16.6678 3.07351 15.6264L1.68769 16.2004ZM21.25 11.5C21.25 12.6751 21.2496 13.5189 21.2042 14.1847C21.1592 14.8438 21.0726 15.2736 20.9265 15.6264L22.3123 16.2004C22.5468 15.6344 22.6505 15.0223 22.7007 14.2868C22.7504 13.5581 22.75 12.6546 22.75 11.5H21.25ZM16.2233 19.7413C17.4786 19.7197 18.3955 19.6457 19.2004 19.3123L18.6264 17.9265C18.1108 18.1401 17.4529 18.2199 16.1975 18.2416L16.2233 19.7413ZM20.9265 15.6264C20.4951 16.6678 19.6678 17.4951 18.6264 17.9265L19.2004 19.3123C20.6093 18.7287 21.7287 17.6093 22.3123 16.2004L20.9265 15.6264ZM13.5 2.75C15.1512 2.75 16.337 2.75079 17.2619 2.83873C18.1757 2.92561 18.7571 3.09223 19.2206 3.37628L20.0044 2.09732C19.2655 1.64457 18.4274 1.44279 17.4039 1.34547C16.3915 1.24921 15.1222 1.25 13.5 1.25V2.75ZM22.75 10.5C22.75 8.87781 22.7508 7.6085 22.6545 6.59611C22.5572 5.57256 22.3554 4.73445 21.9027 3.99563L20.6237 4.77938C20.9078 5.24291 21.0744 5.82434 21.1613 6.73809C21.2492 7.663 21.25 8.84876 21.25 10.5H22.75ZM19.2206 3.37628C19.7925 3.72672 20.2733 4.20752 20.6237 4.77938L21.9027 3.99563C21.4286 3.22194 20.7781 2.57144 20.0044 2.09732L19.2206 3.37628ZM10.5 1.25C8.87781 1.25 7.6085 1.24921 6.59611 1.34547C5.57256 1.44279 4.73445 1.64457 3.99563 2.09732L4.77938 3.37628C5.24291 3.09223 5.82434 2.92561 6.73809 2.83873C7.663 2.75079 8.84876 2.75 10.5 2.75V1.25ZM2.75 10.5C2.75 8.84876 2.75079 7.663 2.83873 6.73809C2.92561 5.82434 3.09223 5.24291 3.37628 4.77938L2.09732 3.99563C1.64457 4.73445 1.44279 5.57256 1.34547 6.59611C1.24921 7.6085 1.25 8.87781 1.25 10.5H2.75ZM3.99563 2.09732C3.22194 2.57144 2.57144 3.22194 2.09732 3.99563L3.37628 4.77938C3.72672 4.20752 4.20752 3.72672 4.77938 3.37628L3.99563 2.09732ZM11.0166 20.0898C10.8136 19.7468 10.6354 19.4441 10.4621 19.2063C10.2795 18.9559 10.0702 18.7304 9.77986 18.5615L9.02572 19.8582C9.07313 19.8857 9.13772 19.936 9.24985 20.0898C9.37122 20.2564 9.50835 20.4865 9.72579 20.8539L11.0166 20.0898ZM7.77666 19.7413C8.21575 19.7489 8.49387 19.7545 8.70588 19.7779C8.90399 19.7999 8.98078 19.832 9.02572 19.8582L9.77986 18.5615C9.4871 18.3912 9.18246 18.3215 8.87097 18.287C8.57339 18.2541 8.21375 18.2487 7.8025 18.2416L7.77666 19.7413ZM14.2742 20.8539C14.4916 20.4865 14.6287 20.2564 14.7501 20.0898C14.8622 19.936 14.9268 19.8857 14.9742 19.8582L14.2201 18.5615C13.9298 18.7304 13.7204 18.9559 13.5379 19.2063C13.3646 19.4441 13.1864 19.7468 12.9833 20.0898L14.2742 20.8539ZM16.1975 18.2416C15.7862 18.2487 15.4266 18.2541 15.129 18.287C14.8175 18.3215 14.5129 18.3912 14.2201 18.5615L14.9742 19.8582C15.0192 19.832 15.096 19.7999 15.2941 19.7779C15.5061 19.7545 15.7842 19.7489 16.2233 19.7413L16.1975 18.2416Z"></path> <path d="M15.5 7.83008L15.6716 8.00165C17.0049 9.33498 17.6716 10.0017 17.6716 10.8301C17.6716 11.6585 17.0049 12.3252 15.6716 13.6585L15.5 13.8301" stroke="#fff" stroke-width="1.5" stroke-linecap="round"></path> <path d="M13.2939 6L11.9998 10.8296L10.7058 15.6593" stroke="#fff" stroke-width="1.5" stroke-linecap="round"></path> <path d="M8.49994 7.83008L8.32837 8.00165C6.99504 9.33498 6.32837 10.0017 6.32837 10.8301C6.32837 11.6585 6.99504 12.3252 8.32837 13.6585L8.49994 13.8301" stroke="#fff" stroke-width="1.5" stroke-linecap="round"></path> </g></svg>
                  </button>
                  <button title="Open this new chat" onclick="changeConnection('/${r.new_id}', false, '${r.new_title}')" class="bg-[#2c2c2c] hover:bg-[#7b7575] text-[8pt] text-white font-bold py-1 px-2 rounded inline-flex items-center">
                  <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" id="chatIcon-${r.new_id}"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M13.0867 21.3877L13.7321 21.7697L13.0867 21.3877ZM13.6288 20.4718L12.9833 20.0898L13.6288 20.4718ZM10.3712 20.4718L9.72579 20.8539H9.72579L10.3712 20.4718ZM10.9133 21.3877L11.5587 21.0057L10.9133 21.3877ZM1.25 10.5C1.25 10.9142 1.58579 11.25 2 11.25C2.41421 11.25 2.75 10.9142 2.75 10.5H1.25ZM3.07351 15.6264C2.915 15.2437 2.47627 15.062 2.09359 15.2205C1.71091 15.379 1.52918 15.8177 1.68769 16.2004L3.07351 15.6264ZM7.78958 18.9915L7.77666 19.7413L7.78958 18.9915ZM5.08658 18.6194L4.79957 19.3123H4.79957L5.08658 18.6194ZM21.6194 15.9134L22.3123 16.2004V16.2004L21.6194 15.9134ZM16.2104 18.9915L16.1975 18.2416L16.2104 18.9915ZM18.9134 18.6194L19.2004 19.3123H19.2004L18.9134 18.6194ZM19.6125 2.7368L19.2206 3.37628L19.6125 2.7368ZM21.2632 4.38751L21.9027 3.99563V3.99563L21.2632 4.38751ZM4.38751 2.7368L3.99563 2.09732V2.09732L4.38751 2.7368ZM2.7368 4.38751L2.09732 3.99563H2.09732L2.7368 4.38751ZM9.40279 19.2098L9.77986 18.5615L9.77986 18.5615L9.40279 19.2098ZM13.7321 21.7697L14.2742 20.8539L12.9833 20.0898L12.4412 21.0057L13.7321 21.7697ZM9.72579 20.8539L10.2679 21.7697L11.5587 21.0057L11.0166 20.0898L9.72579 20.8539ZM12.4412 21.0057C12.2485 21.3313 11.7515 21.3313 11.5587 21.0057L10.2679 21.7697C11.0415 23.0767 12.9585 23.0767 13.7321 21.7697L12.4412 21.0057ZM10.5 2.75H13.5V1.25H10.5V2.75ZM21.25 10.5V11.5H22.75V10.5H21.25ZM7.8025 18.2416C6.54706 18.2199 5.88923 18.1401 5.37359 17.9265L4.79957 19.3123C5.60454 19.6457 6.52138 19.7197 7.77666 19.7413L7.8025 18.2416ZM1.68769 16.2004C2.27128 17.6093 3.39066 18.7287 4.79957 19.3123L5.3736 17.9265C4.33223 17.4951 3.50486 16.6678 3.07351 15.6264L1.68769 16.2004ZM21.25 11.5C21.25 12.6751 21.2496 13.5189 21.2042 14.1847C21.1592 14.8438 21.0726 15.2736 20.9265 15.6264L22.3123 16.2004C22.5468 15.6344 22.6505 15.0223 22.7007 14.2868C22.7504 13.5581 22.75 12.6546 22.75 11.5H21.25ZM16.2233 19.7413C17.4786 19.7197 18.3955 19.6457 19.2004 19.3123L18.6264 17.9265C18.1108 18.1401 17.4529 18.2199 16.1975 18.2416L16.2233 19.7413ZM20.9265 15.6264C20.4951 16.6678 19.6678 17.4951 18.6264 17.9265L19.2004 19.3123C20.6093 18.7287 21.7287 17.6093 22.3123 16.2004L20.9265 15.6264ZM13.5 2.75C15.1512 2.75 16.337 2.75079 17.2619 2.83873C18.1757 2.92561 18.7571 3.09223 19.2206 3.37628L20.0044 2.09732C19.2655 1.64457 18.4274 1.44279 17.4039 1.34547C16.3915 1.24921 15.1222 1.25 13.5 1.25V2.75ZM22.75 10.5C22.75 8.87781 22.7508 7.6085 22.6545 6.59611C22.5572 5.57256 22.3554 4.73445 21.9027 3.99563L20.6237 4.77938C20.9078 5.24291 21.0744 5.82434 21.1613 6.73809C21.2492 7.663 21.25 8.84876 21.25 10.5H22.75ZM19.2206 3.37628C19.7925 3.72672 20.2733 4.20752 20.6237 4.77938L21.9027 3.99563C21.4286 3.22194 20.7781 2.57144 20.0044 2.09732L19.2206 3.37628ZM10.5 1.25C8.87781 1.25 7.6085 1.24921 6.59611 1.34547C5.57256 1.44279 4.73445 1.64457 3.99563 2.09732L4.77938 3.37628C5.24291 3.09223 5.82434 2.92561 6.73809 2.83873C7.663 2.75079 8.84876 2.75 10.5 2.75V1.25ZM2.75 10.5C2.75 8.84876 2.75079 7.663 2.83873 6.73809C2.92561 5.82434 3.09223 5.24291 3.37628 4.77938L2.09732 3.99563C1.64457 4.73445 1.44279 5.57256 1.34547 6.59611C1.24921 7.6085 1.25 8.87781 1.25 10.5H2.75ZM3.99563 2.09732C3.22194 2.57144 2.57144 3.22194 2.09732 3.99563L3.37628 4.77938C3.72672 4.20752 4.20752 3.72672 4.77938 3.37628L3.99563 2.09732ZM11.0166 20.0898C10.8136 19.7468 10.6354 19.4441 10.4621 19.2063C10.2795 18.9559 10.0702 18.7304 9.77986 18.5615L9.02572 19.8582C9.07313 19.8857 9.13772 19.936 9.24985 20.0898C9.37122 20.2564 9.50835 20.4865 9.72579 20.8539L11.0166 20.0898ZM7.77666 19.7413C8.21575 19.7489 8.49387 19.7545 8.70588 19.7779C8.90399 19.7999 8.98078 19.832 9.02572 19.8582L9.77986 18.5615C9.4871 18.3912 9.18246 18.3215 8.87097 18.287C8.57339 18.2541 8.21375 18.2487 7.8025 18.2416L7.77666 19.7413ZM14.2742 20.8539C14.4916 20.4865 14.6287 20.2564 14.7501 20.0898C14.8622 19.936 14.9268 19.8857 14.9742 19.8582L14.2201 18.5615C13.9298 18.7304 13.7204 18.9559 13.5379 19.2063C13.3646 19.4441 13.1864 19.7468 12.9833 20.0898L14.2742 20.8539ZM16.1975 18.2416C15.7862 18.2487 15.4266 18.2541 15.129 18.287C14.8175 18.3215 14.5129 18.3912 14.2201 18.5615L14.9742 19.8582C15.0192 19.832 15.096 19.7999 15.2941 19.7779C15.5061 19.7545 15.7842 19.7489 16.2233 19.7413L16.1975 18.2416Z" fill="#ffffff"></path> </g></svg>
                  </button>
                  <p class="mt-4 text-neutral-500 dark:text-neutral-500">
                    <small>${dateAsGlobal} | Published by
                      <u>${r.new_source}</u></small>
                  </p>
                </div>
              </div>`
  })

  allDataIsSet = true;
}

if (!readOnlyPage) eitherLoginOrLogout();